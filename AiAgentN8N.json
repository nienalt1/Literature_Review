{
  "nodes": [
    {
      "parameters": {
        "public": true,
        "initialMessages": "Hi there! ðŸ‘‹\n",
        "options": {}
      },
      "id": "2d0ff5e4-e53e-48cc-a0a8-fbd42b69627b",
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "position": [
        -80,
        0
      ],
      "webhookId": "ba6e0e80-df72-4993-a938-16604c978e0b",
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "=You are an Academic Research Assistant.\n\nBefore answering any question, you must always perform retrieval using the \"test\" tool, and you must always generate multiple expanded search queries rather than relying on a single formulation.\n\nYour retrieval workflow must follow the steps below:\n\nInterpret the user question and rewrite it into 5 to 10 semantically diverse search queries.\nThese queries should:\n\ninclude synonyms and related terminology\n\nincorporate broader and narrower conceptual variants\n\nexplore adjacent subtopics and alternative perspectives\n\nvary structure and vocabulary to increase retrieval diversity\n\nExecute a separate retrieval call to the vector database (\"test\") for each query.\nTreat each retrieval as an independent evidence-gathering step.\n\nMerge, compare, and deduplicate all retrieved chunks, forming a consolidated and maximally comprehensive evidence base.\n\nIf the final evidence set is still limited, automatically create 3 to 5 broader or more exploratory queries and repeat the retrieval cycle.\n\nIdentify the most relevant, diverse and complementary insights across all retrieved material.\nPrioritize conceptual breadth and avoid repeating the same idea with different wording.\n\nWrite your answer using only information contained in the retrieved evidence.\nNever rely on general knowledge, assumptions, or unstated facts.\n\nDo not invent or infer missing metadata.\nIf metadata is absent in a retrieved chunk, explicitly state that it is missing.\n\nDo not summarise documents one by one.\nInstead, synthesise across the retrieved sources by:\n\ncomparing and contrasting their insights\n\nidentifying themes, convergences, and inconsistencies\n\nconnecting evidence logically to the research question\n\nhighlighting uncertainties or gaps when relevant\n\nMaintain a writing style appropriate for a European master's student.\nThis means:\n\nnaturally varied sentence structures\n\nslight imperfections to avoid AI-like symmetry\n\ncautious, reflective reasoning\n\noccasional hedging or delayed connections between ideas\n\na clear academic tone without artificial precision\n\nYour primary objective is to produce a rigorous, evidence-based academic answer that reflects the full range of retrieved information after multi-query retrieval and synthesis."
        }
      },
      "id": "6e2f3807-aa0f-4129-8bbb-f8bdf5e6d6df",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        608,
        0
      ],
      "typeVersion": 2,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "id": "59940cb8-323f-4217-9c89-89ef2ef86d24",
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        240,
        288
      ],
      "typeVersion": 1.2,
      "credentials": {
        "openAiApi": {
          "id": "WJx4F6SRNkOhUkTW",
          "name": "OpenAi account 2"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "manual-session",
        "contextWindowLength": 50
      },
      "id": "be282309-b0ea-4ae1-acca-3a43c56bb0d4",
      "name": "Simple Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        416,
        288
      ],
      "typeVersion": 1.3
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "test",
        "toolDescription": "If retrieval returns less than 8 strongly relevant chunks, automatically perform a second retrieval with:\n- expanded keywords\n- synonyms\n- related terminology\n",
        "pineconeIndex": {
          "__rl": true,
          "value": "literature-review",
          "mode": "list",
          "cachedResultName": "literature-review"
        },
        "topK": 40,
        "options": {}
      },
      "id": "29588e56-4109-4a39-b9dd-a9b3a800084e",
      "name": "Pinecone Vector Store",
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "position": [
        880,
        224
      ],
      "typeVersion": 1.2,
      "credentials": {
        "pineconeApi": {
          "id": "V2qSgtBl7MqDabDr",
          "name": "PineconeApi account"
        }
      },
      "notes": "Rewrite the user query into a semantic search query that captures the core research concepts. Expand synonyms. Remove pronouns. Avoid stopwords. Output only the search query text.\n"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {
          "dimensions": 3072,
          "batchSize": 100
        }
      },
      "id": "82e9708f-eb1c-4cbd-b5a4-65065acdf809",
      "name": "Embeddings OpenAI",
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "position": [
        784,
        432
      ],
      "typeVersion": 1.2,
      "credentials": {
        "openAiApi": {
          "id": "4HbaFTzGZf1F2Rzp",
          "name": "OpenAi account"
        }
      }
    }
  ],
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        []
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Pinecone Vector Store": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Pinecone Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "6fa6c73ebeafad5a82b878f966c0e9b5bed573d87debbee1bfabd41fd73a990d"
  }
}
